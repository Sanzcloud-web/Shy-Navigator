FROM node:20-bookworm-slim

ENV PNPM_HOME=/root/.local/share/pnpm \
    PATH="/root/.local/share/pnpm:${PATH}" \
    CHOKIDAR_USEPOLLING=1 \
    VITE_HOST=0.0.0.0

WORKDIR /app

# Dependencies first for better caching
COPY package.json package-lock.json* /app/
RUN npm install

# Copy the rest (in dev we will volume-mount anyway)
COPY . /app

EXPOSE 5173

CMD ["npm", "run", "compose:dev"]

